这份文档基于你最终选择的 UI 设计图 (image_4.png 和 image_5.png) 整理而成，旨在为开发团队提供清晰的设计规范和功能需求描述。

---

# Claude Plan Review Web GUI - 设计规范与需求文档

## 1. 设计概述

本项目旨在为 `claude code` 的 Plan Review 过程提供一个现代、清晰且高效的 Web 界面。

* **核心设计风格：** 现代协作文档风 (Modern Collaborative Doc)。
* **设计原则：**
    * **内容优先：** 界面应退居幕后，最大限度地突出 Markdown 计划、代码和图表。
    * **清晰的上下文：** 评论必须与原文有直观的视觉连接，避免上下文丢失。
    * **轻盈与呼吸感：** 通过充足的留白和卡片式设计，减轻阅读长技术文档的视觉压力。
    * **一致性：** 提供精心调配的亮色和暗色主题，保持品牌感（致敬 Claude TUI 配色）。

---

## 2. UI 设计规范 (Design Specifications)

### 2.1. 色彩系统 (Color Palette)

基于 Claude 风格的紫色系作为主色调，辅以中性灰度构建界面层级。

| 用途 | 亮色模式 (Light Mode) | 暗色模式 (Dark Mode) | 说明 |
| :--- | :--- | :--- | :--- |
| **Primary (主色)** | `#7C3AED` (紫色) | `#8B5CF6` (亮紫色) | 主要按钮、高亮选区背景、连接线、图标强调。 |
| **Background (全局背景)** | `#F3F3F3` (米灰) | `#212121` (深炭黑) | 应用的最底层背景。 |
| **Surface (内容卡片背景)** | `#FFFFFF` (纯白) | `#1E1E1E` (墨黑) | 承载 Plan 正文和评论卡片的背景色。 |
| **Surface Alt (代码块背景)**| `#F0F0F0` (浅灰) | `#2D2D2D` (中灰) | 代码块和引用块的背景，需与 Surface 形成对比。 |
| **Text Primary (主要文字)**| `#3C3C3C` (深灰) | `#D4D4D4` (米白) | 正文、标题。 |
| **Text Secondary (次要文字)**| `#6B7280` (中灰) | `#9CA3AF` (浅灰) | 辅助信息、占位符。 |
| **Border/Divider (边框)** | `#E5E7EB` | `#404040` | 分割线、卡片描边。 |
| **Overlay (遮罩层)** | `rgba(0,0,0, 0.4)` | `rgba(0,0,0, 0.6)` | 模态弹窗出现时的背景遮罩。 |

### 2.2. 排版与布局 (Typography & Layout)

* **字体家族：** 推荐使用现代无衬线字体栈，例如 `Inter`, `system-ui`, `-apple-system`, `Segoe UI`, `Roboto`, `Helvetica Neue`, `Arial`, `sans-serif`。代码块使用等宽字体，如 `JetBrains Mono` 或 `Fira Code`。
* **布局结构：**
    * **顶部导航栏 (Top Nav)：** 高度约 60px，包含标题、用户头像、主题切换（可选）和主要的“Finish Review”按钮。
    * **双栏主体：**
        * **左侧/中间内容区 (Main Content)：** 宽度占约 65%-70%，居中显示，采用卡片式设计 (Surface Color)，承载 Markdown 内容。
        * **右侧评论轨 (Comment Rail)：** 宽度占约 30%，用于放置浮动的评论卡片。
* **间距与呼吸感：** 内容卡片内部应有充足的 Padding (如 32px 或 40px)，段落和代码块之间要有明显的 Margin，避免信息过于密集。

### 2.3. 组件样式 (Component Styling)

#### 2.3.1. 评论交互 (Commenting Interaction)
* **高亮状态：** 当用户选中主内容区的文本时，选中文本的背景色应变为半透明的主色调 (Primary Color)，并在行末出现一个连接锚点。
* **连接线：** 一条细线 (1px-2px, Primary Color) 从高亮文本的锚点水平延伸到右侧的评论卡片。
* **评论卡片 (Comment Card)：**
    * 悬浮在右侧评论轨，具有轻微的阴影 (Box Shadow) 以体现层级。
    * 包含用户头像、评论输入框/已保存内容。

#### 2.3.2. 按钮 (Buttons)
* **Primary Button (如 "Finish Review", "Submit All"):** 实心主色背景，白色文字，圆角矩形 (Radius 6px-8px)。Hover 时稍微加深颜色。
* **Secondary/Ghost Button (如 Modal 中的 "Cancel"):** 透明背景，主色或次要文字颜色，Hover 时出现浅灰色背景。

#### 2.3.3. 模态弹窗 (Modal Dialog)
* 居中显示，背后有 Overlay 遮罩。
* 卡片式背景，圆角，有明显的阴影。
* 包含标题、内容列表区（带滚动条）、底部操作按钮区。

---

## 3. 功能需求描述 (Functional Requirements)

### 3.1. Plan 内容渲染 (Plan Rendering)
* **FR-R1: Markdown 解析：** 系统必须能高质量渲染标准的 Markdown 格式，包括标题层级、列表、粗体/斜体等。
* **FR-R2: 代码块高亮：** 必须支持多语言的代码块语法高亮。代码块背景色需遵循主题规范，且最好支持一键复制功能。
* **FR-R3: 图表渲染：** 必须支持渲染 Plan 中嵌入的 Mermaid 流程图、时序图等，且图表的配色需自动适配当前的亮色/暗色主题。

### 3.2. 评论核心流程 (Core Commenting Workflow)
* **FR-C1: 自由文本选择：** 用户可以在主内容区的任意位置（包括普通段落、代码块内部）通过鼠标拖拽选择文本。
* **FR-C2: 触发评论：** 文本选中后，应立即在选区附近出现一个浮动的“添加评论”按钮/图标。
* **FR-C3: 评论输入：** 点击添加按钮后，右侧评论轨对应位置出现评论输入卡片。左侧原文保持高亮，并出现连接线。
* **FR-C4: 暂存评论：** 用户输入内容并点击“保存”后，评论卡片变为阅读状态，该条评论被暂存到本地状态中。

### 3.3. 评论管理与导航 (Comment Management)
* **FR-M1: 视觉定位：** 点击右侧的某条评论卡片，左侧主内容区应自动滚动到对应的原文高亮位置。
* **FR-M2: 评论编辑/删除（可选）：** 已暂存但未提交的评论，应允许用户进行编辑或删除操作。

### 3.4. 提交评审 (Submission Workflow)
* **FR-S1: 完成入口：** 顶部导航栏常驻醒目的“Finish Review”按钮。如果当前有未提交的评论，按钮上可显示数字角标 (badge)。
* **FR-S2: 确认弹窗 (Confirmation Modal)：** 点击“Finish Review”后，弹出模态窗口 (参考 image_5.png)。
* **FR-S3: 评论清单概览：** 弹窗中列出所有待提交的评论摘要（例如：显示原文片段和评论内容的前几个字）。
* **FR-S4: 清单操作：** 在清单中，用户允许点击删除图标移除某条评论。
* **FR-S5: 最终提交：** 点击弹窗中的“Submit All Comments”按钮，将所有暂存的评论数据打包发送给后端 Server，并关闭页面或显示提交成功状态。

### 3.5. 其他支持性需求
* **FR-O1: 主题切换：** 界面应支持亮色和暗色模式切换（可以通过 UI 按钮手动切换，或自动跟随系统设置）。
* **FR-O2: 响应式布局（基础）：** 虽然主要针对桌面端，但在较窄的屏幕上，右侧评论轨应可以折叠或以不覆盖主内容的方式呈现，保证基本的阅读体验。
